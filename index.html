<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>扭摆法测刚体转动惯量数据处理</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        body {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #2980b9;
            margin-top: 25px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        .input-section {
            margin-bottom: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 15px 0;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .results {
            margin-top: 25px;
        }
        .result-item {
            margin-bottom: 15px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .error {
            color: #e74c3c;
            font-weight: bold;
        }
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        .formula {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: "Courier New", monospace;
            border-left: 3px solid #3498db;
        }
        .note {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
        }
        .parallel-axis-table {
            overflow-x: auto;
        }
        .parallel-axis-table table {
            min-width: 800px;
        }
        .sig-fig-explanation {
            margin-top: 20px;
            padding: 10px;
            background-color: #fff9e6;
            border-radius: 5px;
            border-left: 4px solid #ffcc00;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>扭摆法测刚体转动惯量数据处理</h1>
        
        <div class="sig-fig-explanation">
            <strong>有效数字说明：</strong>本程序按照大学物理实验的有效数字规则处理数据：
            <ul>
                <li>测量数据：根据测量仪器的精度确定有效数字位数</li>
                <li>计算数据：乘除法结果的有效数字位数与参与运算的数中有效数字位数最少的相同</li>
                <li>常数（如π）视为无限位有效数字</li>
                <li>科学计数法表示时，只保留有效数字部分</li>
            </ul>
        </div>
        
        <div class="input-section">
            <h2>实验数据输入</h2>
            <table>
                <tr>
                    <th>测量对象</th>
                    <th>物理量</th>
                    <th>数值</th>
                    <th>单位</th>
                </tr>
                <tr>
                    <td rowspan="1">金属载物盘</td>
                    <td>摆动周期 T₀</td>
                    <td><input type="number" id="T0" step="0.001" min="0"></td>
                    <td>秒(s)</td>
                </tr>
                <tr>
                    <td rowspan="2">塑料圆柱体</td>
                    <td>摆动周期 T₁</td>
                    <td><input type="number" id="T1" step="0.001" min="0"></td>
                    <td>秒(s)</td>
                </tr>
                <tr>
                    <td>质量 M₁</td>
                    <td><input type="number" id="M1" step="0.001" min="0"></td>
                    <td>千克(kg)</td>
                </tr>
                <tr>
                    <td rowspan="1">塑料圆柱体</td>
                    <td>直径 D₁</td>
                    <td><input type="number" id="D1" step="0.001" min="0"></td>
                    <td>米(m)</td>
                </tr>
                <tr>
                    <td rowspan="2">金属圆筒</td>
                    <td>摆动周期 T₂</td>
                    <td><input type="number" id="T2" step="0.001" min="0"></td>
                    <td>秒(s)</td>
                </tr>
                <tr>
                    <td>质量 M₂</td>
                    <td><input type="number" id="M2" step="0.001" min="0"></td>
                    <td>千克(kg)</td>
                </tr>
                <tr>
                    <td rowspan="2">金属圆筒</td>
                    <td>内径 d₁</td>
                    <td><input type="number" id="d1" step="0.001" min="0"></td>
                    <td>米(m)</td>
                </tr>
                <tr>
                    <td>外径 d₂</td>
                    <td><input type="number" id="d2" step="0.001" min="0"></td>
                    <td>米(m)</td>
                </tr>
                <tr>
                    <td rowspan="3">金属细杆</td>
                    <td>摆动周期 T₃</td>
                    <td><input type="number" id="T3" step="0.001" min="0"></td>
                    <td>秒(s)</td>
                </tr>
                <tr>
                    <td>质量 M₃</td>
                    <td><input type="number" id="M3" step="0.001" min="0"></td>
                    <td>千克(kg)</td>
                </tr>
                <tr>
                    <td>长度 L</td>
                    <td><input type="number" id="L" step="0.001" min="0"></td>
                    <td>米(m)</td>
                </tr>
            </table>
            
            <h2>验证平行轴定理数据输入</h2>
            <div class="parallel-axis-table">
                <table>
                    <tr>
                        <th>滑块位置 x (cm)</th>
                        <th>摆动周期 T₄ (s)</th>
                        <th>滑块质量 m (kg)</th>
                        <th>滑块高度 h (m)</th>
                        <th>滑块内径 d内 (m)</th>
                        <th>滑块外径 d外 (m)</th>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td><input type="number" id="T4_5" step="0.001" min="0"></td>
                        <td rowspan="5"><input type="number" id="m" step="0.001" min="0"></td>
                        <td rowspan="5"><input type="number" id="h" step="0.001" min="0"></td>
                        <td rowspan="5"><input type="number" id="d_inner" step="0.001" min="0"></td>
                        <td rowspan="5"><input type="number" id="d_outer" step="0.001" min="0"></td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td><input type="number" id="T4_10" step="0.001" min="0"></td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td><input type="number" id="T4_15" step="0.001" min="0"></td>
                    </tr>
                    <tr>
                        <td>20</td>
                        <td><input type="number" id="T4_20" step="0.001" min="0"></td>
                    </tr>
                    <tr>
                        <td>25</td>
                        <td><input type="number" id="T4_25" step="0.001" min="0"></td>
                    </tr>
                </table>
            </div>
            
            <button onclick="calculate()">计算</button>
        </div>
        
        <div class="results" id="results" style="display: none;">
            <h2>计算结果</h2>
            
            <div class="result-item">
                <h3>1. 弹簧扭转系数 k</h3>
                <div class="formula">k = 4π² × 0.125 × M₁ × D₁² / (T₁² - T₀²)</div>
                <p>计算结果: k = <span id="k-value"></span> N·m/rad</p>
            </div>
            
            <div class="result-item">
                <h3>2. 金属载物盘的转动惯量</h3>
                <div class="formula">实验值 I₀ = k × T₀² / (4π²)</div>
                <p>计算结果: I₀ = <span id="I0-value"></span> kg·m²</p>
            </div>
            
            <div class="result-item">
                <h3>3. 塑料圆柱体的转动惯量</h3>
                <div class="formula">理论值 I₁' = 0.125 × M₁ × D₁²</div>
                <p>计算结果: I₁' = <span id="I1-theory"></span> kg·m²</p>
                
                <div class="formula">实验值 I₁ = k × T₁² / (4π²) - I₀</div>
                <p>计算结果: I₁ = <span id="I1-experiment"></span> kg·m²</p>
                
                <p>百分比误差: <span id="I1-error"></span></p>
            </div>
            
            <div class="result-item">
                <h3>4. 金属圆筒的转动惯量</h3>
                <div class="formula">理论值 I₂' = 0.125 × M₂ × (d₁² + d₂²)</div>
                <p>计算结果: I₂' = <span id="I2-theory"></span> kg·m²</p>
                
                <div class="formula">实验值 I₂ = k × T₂² / (4π²) - I₀</div>
                <p>计算结果: I₂ = <span id="I2-experiment"></span> kg·m²</p>
                
                <p>百分比误差: <span id="I2-error"></span></p>
            </div>
            
            <div class="result-item">
                <h3>5. 金属细杆的转动惯量</h3>
                <div class="formula">理论值 I₃' = (1/12) × M₃ × L²</div>
                <p>计算结果: I₃' = <span id="I3-theory"></span> kg·m²</p>
                
                <div class="formula">实验值 I₃ = k × T₃² / (4π²) - 0.232 × 10⁻⁴</div>
                <p>计算结果: I₃ = <span id="I3-experiment"></span> kg·m²</p>
                <p class="note">注: 式中减去的 0.232×10⁻⁴ 为夹具的转动惯量</p>
                
                <p>百分比误差: <span id="I3-error"></span></p>
            </div>
            
            <div class="result-item" id="parallel-axis-results">
                <h3>6. 验证平行轴定理</h3>
                <div class="parallel-axis-table">
                    <table>
                        <tr>
                            <th>滑块位置 x (cm)</th>
                            <th>滑块位置 x (m)</th>
                            <th>摆动周期 T₄ (s)</th>
                            <th>实验值 I₄ (kg·m²)</th>
                            <th>理论值 I₄' (kg·m²)</th>
                            <th>百分比误差</th>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td id="x_5_m"></td>
                            <td id="T4_5_display"></td>
                            <td id="I4_5_exp"></td>
                            <td id="I4_5_theory"></td>
                            <td id="I4_5_error"></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td id="x_10_m"></td>
                            <td id="T4_10_display"></td>
                            <td id="I4_10_exp"></td>
                            <td id="I4_10_theory"></td>
                            <td id="I4_10_error"></td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td id="x_15_m"></td>
                            <td id="T4_15_display"></td>
                            <td id="I4_15_exp"></td>
                            <td id="I4_15_theory"></td>
                            <td id="I4_15_error"></td>
                        </tr>
                        <tr>
                            <td>20</td>
                            <td id="x_20_m"></td>
                            <td id="T4_20_display"></td>
                            <td id="I4_20_exp"></td>
                            <td id="I4_20_theory"></td>
                            <td id="I4_20_error"></td>
                        </tr>
                        <tr>
                            <td>25</td>
                            <td id="x_25_m"></td>
                            <td id="T4_25_display"></td>
                            <td id="I4_25_exp"></td>
                            <td id="I4_25_theory"></td>
                            <td id="I4_25_error"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 有效数字处理函数
        function toSignificantFigures(value, sigFigs) {
            if (value === 0) return '0';
            
            // 处理科学计数法
            const exponent = Math.floor(Math.log10(Math.abs(value)));
            const magnitude = Math.pow(10, exponent - sigFigs + 1);
            
            // 四舍五入到指定有效数字
            const rounded = Math.round(value / magnitude) * magnitude;
            
            // 转换为科学计数法字符串
            const scientific = rounded.toExponential(sigFigs - 1);
            
            // 检查是否需要转换为普通表示法
            const [coefficient, expPart] = scientific.split('e');
            const exponentValue = parseInt(expPart);
            
            // 如果指数在-3到3之间，使用普通表示法
            if (exponentValue >= -3 && exponentValue <= 3) {
                // 计算小数点后位数
                const decimalPlaces = Math.max(0, sigFigs - 1 - exponentValue);
                return rounded.toFixed(decimalPlaces);
            }
            
            return scientific;
        }
        
        // 获取输入值的有效数字位数（基于输入的小数位数）
        function getSignificantFigures(value) {
            if (!value && value !== 0) return 4; // 默认4位
            
            const str = value.toString();
            
            // 如果是科学计数法，直接返回4位
            if (str.includes('e')) return 4;
            
            // 计算小数点后的位数
            if (str.includes('.')) {
                const decimalPart = str.split('.')[1];
                // 对于测量数据，通常有3-4位有效数字
                return Math.min(Math.max(decimalPart.length, 3), 4);
            }
            
            // 整数输入，假设有3位有效数字
            return 3;
        }
        
        function calculate() {
            // 获取输入值
            const T0 = parseFloat(document.getElementById('T0').value);
            const T1 = parseFloat(document.getElementById('T1').value);
            const M1 = parseFloat(document.getElementById('M1').value);
            const D1 = parseFloat(document.getElementById('D1').value);
            const T2 = parseFloat(document.getElementById('T2').value);
            const M2 = parseFloat(document.getElementById('M2').value);
            const d1 = parseFloat(document.getElementById('d1').value);
            const d2 = parseFloat(document.getElementById('d2').value);
            const T3 = parseFloat(document.getElementById('T3').value);
            const M3 = parseFloat(document.getElementById('M3').value);
            const L = parseFloat(document.getElementById('L').value);
            
            // 验证输入
            if (isNaN(T0) || isNaN(T1) || isNaN(M1) || isNaN(D1) || 
                isNaN(T2) || isNaN(M2) || isNaN(d1) || isNaN(d2) || 
                isNaN(T3) || isNaN(M3) || isNaN(L)) {
                alert("请填写所有基本数据！");
                return;
            }
            
            // 获取有效数字位数（基于输入数据的小数位数）
            const sigFigs = 4; // 统一使用4位有效数字，符合大学物理实验要求
            
            // 计算常数
            const pi = Math.PI;
            const fourPiSquared = 4 * pi * pi;
            
            // 1. 计算弹簧扭转系数 k
            const k = (fourPiSquared * 0.125 * M1 * D1 * D1) / (T1 * T1 - T0 * T0);
            
            // 2. 计算金属载物盘的转动惯量实验值 I0
            const I0 = k * T0 * T0 / fourPiSquared;
            
            // 3. 塑料圆柱体的转动惯量
            const I1_theory = 0.125 * M1 * D1 * D1;
            const I1_experiment = k * T1 * T1 / fourPiSquared - I0;
            const I1_error = Math.abs((I1_experiment - I1_theory) / I1_theory * 100);
            
            // 4. 金属圆筒的转动惯量
            const I2_theory = 0.125 * M2 * (d1 * d1 + d2 * d2);
            const I2_experiment = k * T2 * T2 / fourPiSquared - I0;
            const I2_error = Math.abs((I2_experiment - I2_theory) / I2_theory * 100);
            
            // 5. 金属细杆的转动惯量
            const I3_theory = (1/12) * M3 * L * L;
            const I3_experiment = k * T3 * T3 / fourPiSquared - 0.232e-4;
            const I3_error = Math.abs((I3_experiment - I3_theory) / I3_theory * 100);
            
            // 使用有效数字规则显示结果
            document.getElementById('k-value').textContent = toSignificantFigures(k, sigFigs);
            document.getElementById('I0-value').textContent = toSignificantFigures(I0, sigFigs);
            
            document.getElementById('I1-theory').textContent = toSignificantFigures(I1_theory, sigFigs);
            document.getElementById('I1-experiment').textContent = toSignificantFigures(I1_experiment, sigFigs);
            document.getElementById('I1-error').textContent = I1_error.toFixed(2) + "%";
            
            document.getElementById('I2-theory').textContent = toSignificantFigures(I2_theory, sigFigs);
            document.getElementById('I2-experiment').textContent = toSignificantFigures(I2_experiment, sigFigs);
            document.getElementById('I2-error').textContent = I2_error.toFixed(2) + "%";
            
            document.getElementById('I3-theory').textContent = toSignificantFigures(I3_theory, sigFigs);
            document.getElementById('I3-experiment').textContent = toSignificantFigures(I3_experiment, sigFigs);
            document.getElementById('I3-error').textContent = I3_error.toFixed(2) + "%";
            
            // 显示结果区域
            document.getElementById('results').style.display = 'block';
            
            // 计算平行轴定理部分
            calculateParallelAxis(k, I3_experiment, sigFigs);
        }
        
        function calculateParallelAxis(k, I3, sigFigs) {
            // 获取输入值
            const T4_5 = parseFloat(document.getElementById('T4_5').value);
            const T4_10 = parseFloat(document.getElementById('T4_10').value);
            const T4_15 = parseFloat(document.getElementById('T4_15').value);
            const T4_20 = parseFloat(document.getElementById('T4_20').value);
            const T4_25 = parseFloat(document.getElementById('T4_25').value);
            const m = parseFloat(document.getElementById('m').value);
            const h = parseFloat(document.getElementById('h').value);
            const d_inner = parseFloat(document.getElementById('d_inner').value);
            const d_outer = parseFloat(document.getElementById('d_outer').value);
            
            // 如果平行轴定理数据不完整，则不计算
            if (isNaN(T4_5) || isNaN(T4_10) || isNaN(T4_15) || isNaN(T4_20) || isNaN(T4_25) || 
                isNaN(m) || isNaN(h) || isNaN(d_inner) || isNaN(d_outer)) {
                document.getElementById('parallel-axis-results').style.display = 'none';
                return;
            }
            
            // 计算常数
            const pi = Math.PI;
            const fourPiSquared = 4 * pi * pi;
            
            // 滑块位置（转换为米）
            const positions = [0.05, 0.10, 0.15, 0.20, 0.25];
            const periods = [T4_5, T4_10, T4_15, T4_20, T4_25];
            
            // 计算每个位置的实验值和理论值
            for (let i = 0; i < positions.length; i++) {
                const x = positions[i];
                const T4 = periods[i];
                
                // 实验值 I4 = (k * T4^2 / (4pi^2) - I3 - 0.232*10^-4) * 0.5
                const I4_exp = (k * T4 * T4 / fourPiSquared - I3 - 0.232e-4) * 0.5;
                
                // 理论值 I4' = (1/16*m*(d内^2+d外^2) + 1/12*m*h^2) + m*x^2
                const I4_theory = (1/16 * m * (d_inner*d_inner + d_outer*d_outer) + 1/12 * m * h * h) + m * x * x;
                
                // 百分比误差
                const error = Math.abs((I4_exp - I4_theory) / I4_theory * 100);
                
                // 使用有效数字规则显示结果
                document.getElementById(`x_${x*100}_m`).textContent = x.toFixed(3);
                document.getElementById(`T4_${x*100}_display`).textContent = T4.toFixed(3);
                document.getElementById(`I4_${x*100}_exp`).textContent = toSignificantFigures(I4_exp, sigFigs);
                document.getElementById(`I4_${x*100}_theory`).textContent = toSignificantFigures(I4_theory, sigFigs);
                document.getElementById(`I4_${x*100}_error`).textContent = error.toFixed(2) + "%";
            }
            
            // 显示平行轴定理结果
            document.getElementById('parallel-axis-results').style.display = 'block';
        }
    </script>
</body>
</html>